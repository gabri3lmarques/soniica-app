class AccordionMenu{constructor(){this.accordionItems=document.querySelectorAll(".accordion-item"),this.init()}init(){this.accordionItems.forEach(o=>{o.querySelector(".accordion-header").addEventListener("click",()=>{var t=o,e=t.classList.contains("active");this.accordionItems.forEach(t=>{t.classList.remove("active"),t.querySelector(".accordion-content").style.maxHeight=null}),e||(t.classList.add("active"),(e=t.querySelector(".accordion-content")).style.maxHeight=e.scrollHeight+"px")})})}}document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".accordion-item")&&new AccordionMenu});let fm_close=document.querySelector(".fm-close"),modal=document.querySelector(".flash-message-overlay");fm_close&&fm_close.addEventListener("click",function(){modal.style.display="none"});class Player{constructor(){this.audio=new Audio,this.currentSong=null,this.currentPlaylist=null,this.isPlaying=!1,this.isLooping=!1,this.isRandom=!1,this.titleElement=document.querySelector(".current-title"),this.artistElement=document.querySelector(".current-artist"),this.timeElement=document.querySelector(".current-time"),this.gendersElement=document.querySelector(".current-genders"),this.thumbElement=document.querySelector(".current-thumb"),this.playPauseButton=document.querySelector(".play-pause"),this.nextButton=document.querySelector(".next"),this.previousButton=document.querySelector(".previous"),this.loopButton=document.querySelector(".loop"),this.randomButton=document.querySelector(".random"),this.progressBarContainer=document.querySelector(".progress-bar-container"),this.progressBar=document.querySelector(".progress-bar"),this.volumeSlider=document.querySelector("#volume-slider"),this.playPauseButton.addEventListener("click",()=>this.togglePlayPause()),this.nextButton.addEventListener("click",()=>this.next()),this.previousButton.addEventListener("click",()=>this.previous()),this.loopButton.addEventListener("click",()=>this.toggleLoop()),this.randomButton.addEventListener("click",()=>this.toggleRandom()),this.audio.addEventListener("timeupdate",()=>this.updateProgressBar()),this.audio.addEventListener("ended",()=>this.handleSongEnd()),this.volumeSlider.addEventListener("input",t=>this.adjustVolume(t)),this.progressBarContainer.addEventListener("click",t=>this.seek(t)),this.progressBarContainer.addEventListener("mousedown",t=>this.startDrag(t)),this.initializeFirstSong(),this.audio.volume=this.volumeSlider.value}adjustVolume(t){var t=t.target.value,e=100*t,o=100-e;this.audio.volume=t,this.volumeSlider.style.background=`linear-gradient(to right, #708303, #e9ff70 ${e}%, #272727 ${o}%)`}initializeFirstSong(){var t=document.querySelector(".playlist");if(t){var e=t.querySelector(".song");if(e){this.currentPlaylist=t;t=(this.currentSong=e).dataset.src;try{var o=atob(t);o.startsWith("http://")||o.startsWith("https://")?(this.audio.src=o,this.updatePlayerInfo(e)):console.error("Invalid decoded URL:",o)}catch(t){console.error("Error decoding URL:",t)}}}}toggleRandom(){this.isRandom=!this.isRandom,this.isRandom?this.randomButton.classList.add("active"):this.randomButton.classList.remove("active")}getRandomSong(){var t=[...this.currentPlaylist.querySelectorAll(".song")];let e;for(;(e=t[Math.floor(Math.random()*t.length)])===this.currentSong&&1<t.length;);return e}getNextSong(){var t,e;return this.isRandom?this.getRandomSong():(e=(t=[...this.currentPlaylist.querySelectorAll(".song")]).findIndex(t=>t===this.currentSong),t[e+1]||(this.isLooping?t[0]:null))}getPreviousSong(){var t=[...this.currentPlaylist.querySelectorAll(".song")],e=t.findIndex(t=>t===this.currentSong);return t[e-1]||(this.isLooping?t[t.length-1]:null)}play(t,e){try{var o=t.dataset.src,s=atob(o);s.startsWith("http://")||s.startsWith("https://")?(this.currentSong&&this.currentSong!==t&&(this.currentSong.querySelector(".play-button").classList.remove("active"),this.currentSong.classList.remove("active")),this.audio.src!==s&&(this.audio.src=s),this.audio.play(),this.isPlaying=!0,this.currentSong=t,this.currentPlaylist=e,this.updatePlayerInfo(t),this.syncButtons(t)):console.error("Invalid decoded URL:",s)}catch(t){console.error("Error playing song:",t)}}pause(t=null){var e;this.audio.pause(),this.isPlaying=!1,t&&((e=t.querySelector(".play-button"))&&e.classList.remove("active"),t.classList.remove("active")),this.playPauseButton.classList.remove("active")}togglePlayPause(){this.isPlaying?this.pause(this.currentSong):(this.audio.play(),this.isPlaying=!0,this.currentSong.querySelector(".play-button").classList.add("active"),this.currentSong.classList.add("active"),this.playPauseButton.classList.add("active"))}toggleLoop(){this.isLooping=!this.isLooping,this.isLooping?this.loopButton.classList.add("active"):this.loopButton.classList.remove("active")}next(){var t=this.getNextSong();t&&this.play(t,this.currentPlaylist)}previous(){var t;2<this.audio.currentTime?this.audio.currentTime=0:(t=this.getPreviousSong())&&this.play(t,this.currentPlaylist)}handleSongEnd(){var t=this.getNextSong();t?this.play(t,this.currentPlaylist):(this.isPlaying=!1,this.audio.currentTime=0,this.syncButtons(null))}updatePlayerInfo(t){this.titleElement.textContent=t.querySelector(".title").textContent,this.artistElement.textContent=t.querySelector(".artist").textContent,this.timeElement.textContent=t.querySelector(".time").textContent;t=t.querySelector(".thumb").src;this.thumbElement.src=t}syncButtons(t){document.querySelectorAll(".play-button").forEach(t=>t.classList.remove("active")),document.querySelectorAll(".song").forEach(t=>t.classList.remove("active")),t?(t.querySelector(".play-button").classList.add("active"),t.classList.add("active"),this.playPauseButton.classList.add("active")):this.playPauseButton.classList.remove("active")}updateProgressBar(){var t=this.audio.currentTime/this.audio.duration*100;this.progressBar.style.width=t+"%"}seek(t){var e=this.progressBarContainer.getBoundingClientRect(),t=t.clientX-e.left;this.audio.currentTime=t/e.width*this.audio.duration}startDrag(t){let e=t=>this.seek(t),o=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",o),this.seek(t)}}document.querySelector("#player-main")&&(window.globalPlayer=new Player,document.addEventListener("click",t=>{var e,t=t.target.closest(".play-button");t&&(e=t.closest(".song"),t=t.closest(".playlist"),e)&&t&&(globalPlayer.currentSong===e&&globalPlayer.isPlaying?globalPlayer.pause(e):globalPlayer.play(e,t))}));let userAvatar=document.querySelector(".user-avatar"),userSubMenu=document.querySelector(".user-sub-menu");function handleDownload(e){return fetch(wpApiSettings.root+"soniica/v1/register-download",{method:"POST",headers:{"X-WP-Nonce":wpApiSettings.nonce,"Content-Type":"application/json"},credentials:"same-origin"}).then(t=>t.json()).then(t=>{if(!t.success)return e.preventDefault(),alert(t.message),!1;t.is_premium||document.querySelectorAll(".download-link").forEach(t=>{t.classList.add("download-blocked"),t.setAttribute("title","You have reached the download limit on free plan today."),t.setAttribute("href","/get-premium"),t.removeAttribute("download")})}).catch(t=>(console.error("Erro:",t),e.preventDefault(),!1)),!0}userAvatar&&userSubMenu&&(userAvatar.addEventListener("click",function(t){userSubMenu.classList.toggle("active")}),document.addEventListener("click",function(t){userAvatar.contains(t.target)||userSubMenu.contains(t.target)||userSubMenu.classList.remove("active")}));let playerDownloadButtons=document.querySelectorAll(".download-link");function isBase64(t){try{return btoa(atob(t))===t}catch(t){return!1}}let PlayerManager=(()=>{let t=null;return{getInstance:function(){return t=t||new Player}}})();function stopGlobalPlayer(){window.globalPlayer&&window.globalPlayer.currentSong&&window.globalPlayer.pause(window.globalPlayer.currentSong)}playerDownloadButtons.forEach(o=>{o.addEventListener("click",t=>{t.preventDefault();t=o.getAttribute("href");let e="";isBase64(t)?(e=atob(t),o.classList.contains("download-blocked")?console.log("deu ruim"):window.open(e,"_blank")):(e=t,window.location.href=e)})}),window.addEventListener("beforeunload",function(t){stopGlobalPlayer()});
//# sourceMappingURL=main.min.js.map
